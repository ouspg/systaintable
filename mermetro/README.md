# Mermetro

Mermetro is a tool made for visualization of data from OUSPG ID.ID's or ID.Trace's output using **Mermaid 10.9.3**

The Python script processes .json files generated by the tools:
* It creates pairs from entries that appear on the same line.
* If pair A and pair B share a common entry, they are merged to form a group.
* Groups share the same logic in merging, which will merge even larger groups.
* This grouping process is repeated until all possible merges are done.

### v1

Mermetro v1 provides an overview of the whole log file. It generates an interactive **flowchart** metro map with features like:

* Timestamp filtering
* Filtering out entries from grouping process
* Searching for exact entries
* Group forming logs

### v2

Mermetro v2 is an **additional** tool for v1. While v1 focuses on the whole log file, v2 focuses on a single id. It generates two different diagrams, group forming log and a node relationships. 

v2 presents information using diagrams; v1 provides text-only output.


## Project tree

```
mermetro/
├── v1/
│   ├── static/
│   │   ├── favicon.ico
│   ├── templates/
│   │   ├── sivusto.html
│   ├── mermetro.py
├── v2/
│   ├── static/
│   │   ├── favicon.ico
│   ├── templates/
│   │   ├── group_timeline.html
│   ├── mermetro2.py
│   ├── nodes.py
│   ├── formation.py
├── data/
│   ├── common_values.txt
│   ├── README.md
├── requirements.txt
├── README.md
├── .gitignore
└── start.py

```

## Usage

Install requirements

```console
pip install -r requirements.txt
```

 Place the `.json` file exported from ID.ID or ID.Trace into the `mermetro/data/` directory

Below is an exaple how to properly run `start.py`. It can take several minutes to complete with larger files.
Flags:

    -m  Multiprocessing

    --mode 

        0 = Both (default)

        1 = Only v1

        2 = Only v2

```console
python3 start.py data/lokitiedosto.json -m --mode 2
```

Open http://localhost:5000
AND/OR
http://localhost:5001

### OSX venv

1. Create a virtual environment
```python3 -m venv venv```

2. Activate the virtual environment
```source venv/bin/activate```

3. Install pytz (and any other dependencies)
```pip install flask```

4. Run mermetro
```python mermetro.py```

5. To deactivate the virtual environment when done:
```deactivate```
